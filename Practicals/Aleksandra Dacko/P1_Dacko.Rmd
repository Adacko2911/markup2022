---
title: "P1_Dacko"
author: "Aleksandra Dacko"
date: "9/14/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(future)
library(tidyverse)
library(furrr)
library(DT)
```


* Sample 100 samples from a standard normal distribution.

```{r}

plan(multisession,workers=3)

NEW<-1:100 %>% future_map( function(x){
  x <- rnorm(5000,mean=0,sd=1)
  M <- mean(x)
  AB<-M-0
  DF <- length(x) - 1
  SE <- 1 / sqrt(length(x))
  QT<-(qt(.975, DF) * SE)
  return(c(mean=M,
         bias=AB,
         std_err=SE,
         lower=M-QT,
         upper=M+QT,
         cov = M - QT < 0 & 0 < M + QT))},.options = furrr_options(seed = 123),.progress = TRUE
  ) %>% do.call("rbind", .) %>% as_tibble

NEW
```
```{r}
NEW%>% colMeans()
```

```{r}
NEW %>% filter(cov==0)
```
```{r}
library(ggplot2)
#factor(NEW$cov,levels = c("not","yes"))
limits <- aes(ymax = NEW$upper, ymin = NEW$lower)
NEW %>% mutate(covered = as.factor(cov)) %>% 
ggplot(aes(y=mean, x=1:100, colour = covered)) + 
  geom_hline(aes(yintercept = 0), color = "dark grey", size = 2) + 
  geom_pointrange(limits) + 
  xlab("Simulations") +
  ylab("Means and 95% Confidence Intervals")+ggtitle("The 95% confidence intervals")
```



```{r}
NEW %>% round(4) %>% filter((lower>0 & upper>0 )| (lower<0 & upper<0) ) %>%select(-cov) %>% DT::datatable()
```

```{r}

```

